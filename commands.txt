>>> Make sure Docker starts on boot (host / VM) <<<<
$ sudo systemctl enable docker
$ sudo systemctl start docker

Check:
$ systemctl is-enabled docker

>>> After VM reboot, do only this: <<<
$ cd /media/sf_shared/Inception/srcs
$ docker compose up -d

>>> Verify docker and mariadb are runnig <<<
$ docker ps

then:
$ docker logs mariadb

>>> To clean start but keep data <<<
$ docker compose down
$ docker compose up -d

>>> Fo full reset (delete DB!) <<<
$ docker compose down
$ sudo rm -rf /home/$USER/data/mariadb/*


cd /media/sf_shared/Inception/srcs
$ docker compose up -d
$ docker logs mariadb

Prove wordpress works (without browser)
$ docker exec -it wordpress ps aux | grep php-fpm
$ ls ~/data/wordpress
$ cat ~/data/wordpress/wp-config.php

✔ All pass → WordPress is READY

Option A (safe, no permission changes): read it from inside the container
$ docker exec -it wordpress cat /var/www/html/wp-config.php

Option B: check ownership/permissions on the host
ls -l ~/data/wordpress/wp-config.php

Make the file readable (by root user) (but keep it not world-readable):
1. Change owner to you:
$ sudo chown mzhivoto:mzhivoto ~/data/wordpress/wp-config.php

2. Set permissions
$ sudo chmod 640 ~/data/wordpress/wp-config.php

should work now:
$ cat ~/data/wordpress/wp-config.php


debugging:

See what php-fpm is listening on

$ docker exec -it wordpress sh -lc "grep -n '^listen' /etc/php/8.2/fpm/pool.d/www.conf"

mzhivoto@Inception:/media/sf_shared/Inception/srcs$ docker exec -it wordpress sh -lc "grep -n '^listen' /etc/php/8.2/fpm/pool.d/www.conf; grep -n 'allowed_clients' /etc/php/8.2/fpm/pool.d/www.conf || echo 'allowed_clients not set'"
41:listen = 0.0.0.0:9000
53:listen.owner = www-data
54:listen.group = www-data
69:;listen.allowed_clients = 127.0.0.1

$ curl -kI https://mzhivoto.42.fr - want to have 200 status
mzhivoto@Inception:/media/sf_shared/Inception/srcs$ curl -kI https://mzhivoto.42.fr
HTTP/2 500 
server: nginx/1.22.1
date: Wed, 17 Dec 2025 17:10:52 GMT
content-type: text/html; charset=UTF-8


CHECK we do not have anything:
1️⃣ Check containers (WordPress / MariaDB / Nginx):
$ docker ps -a
You should NOT see:
nginx
wordpress
mariadb
If nothing from your project is listed → ✅ containers are gone.

2️⃣ Check volumes
$ docker volume ls

You should NOT see volumes related to Inception
(especially since you use bind mounts, this should usually be empty or unrelated).

3️⃣ Check networks
$ docker network ls

There should be no custom inception network
Only defaults like:

bridge
host
none
If inception is gone → ✅

4️⃣ Check images (optional but good)
$ docker images

You may still see images like:

nginx
debian
unnamed <none>
⚠️ Images can exist and this is OK for the subject.
They don’t count as “running services”.

If you want to clean them anyway:
$ docker image prune -f

5️⃣ Check host data folders (VERY IMPORTANT)
Since you bind-mount:
$ ls -la /home/mzhivoto/data
You should see:

either nothing
or empty mariadb/ and wordpress/ folders
Check inside:
$ ls -la /home/mzhivoto/data/mariadb
$ ls -la /home/mzhivoto/data/wordpress

6️⃣ Check ports (ensure nothing listens on 443)
$ sudo ss -tulpn | grep :443

There should be no output.
If something is listening → nginx is still running somewhere.

7️⃣ One-line “everything clean?” command
$ docker ps -a && docker network ls && ls -la /home/mzhivoto/data

REQUIRED: full reset
make down
docker compose -f srcs/docker-compose.yml down -v --remove-orphans
sudo rm -rf /home/mzhivoto/data/mariadb /home/mzhivoto/data/wordpress
docker image rm -f mariadb:42 wordpress:42 nginx:42 2>/dev/null || true
make up

docker exec -it wordpress mariadb -h mariadb -u wp_user -p"$(cat /run/secrets/db_password)" -e "SELECT 1;"
docker exec -it wordpress ss -lntp | grep 9000
curl -k https://mzhivoto.42.fr